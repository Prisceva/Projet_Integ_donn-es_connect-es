<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<title>PROJET API</title>
	</head>
	<body>
		<p>test 7 </p>
		<table id = "tab_MDPH">
       	</table>
		
	</body>
	<script>
	
	var dep= document.getElementById("dep").value;
	//API MDPH
	var result_MDPH;
	fetch('https://api.opendata.onisep.fr/api/1.0/dataset/57e13aa4a3cee/search?size=300')
	  .then(function(response) {
	    response.json()
		.then(function(data) {
	    console.log('Request successful');
		    result_MDPH=data;
		    
		    // Réccupérer MDPH :
		    var nom= new Array;
		    var adresse= new Array;
		    var commune= new Array;
		    var cp= new Array;
		    var lien= new Array;
		    
		    for (i=0;i<result_MDPH.results.length;i++){
			    if (result_MDPH.results[i]["departement"] == dep) {
				    nom.push(result_MDPH.results[i]["nom"]);
				    adresse.push(result_MDPH.results[i]["adresse"]);
				    commune.push(result_MDPH.results[i]["commune"]);
				    cp.push(result_MDPH.results[i]["cp"]);
				    lien.push(result_MDPH.results[i]["lien_site_onisepfr"])
			    }
		    };
		    
		    var text="";
		    // On défini les en tetes :
		    text = text + "<tr><th>Nom</th><th>Adresse</th><th>Code Postal</th><th>Commune</th><th>Site web</th></tr>";
		    
		    for (i in nom){ // Pour chaque département.
			   //console.log(nom[i]);
			    text = text + "<tr><td>"+nom[i]+"</td><td>"+adresse[i]+"</td><td>"+cp[i]+"</td><td>"+commune[i]+"</td><td>"+lien[i]+"</td></tr>"; 
		    }
		    //console.log(text);
		    var donnee_MDPH = document.getElementById("tab_MDPH");
		    donnee_MDPH.innerHTML=text;  	    
		    
			
			
	  })})
		
		result_MDPH;
		
	
	</script>
	
</html>
